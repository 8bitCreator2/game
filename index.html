<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Stardust</title>
  <style>
    :root {
      --bg: #000000;
      --panel: #0a0a0a;
      --line: #1f1f1f;
      --text: #f4f4f4;
      --muted: #9a9a9a;
      --accent: #ffffff;
      --good: #d6ffd6;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      display: grid;
      place-items: center;
      background: var(--bg);
      color: var(--text);
      font-family: "SF Mono", "IBM Plex Mono", Menlo, Consolas, monospace;
      padding: 1rem;
    }

    .app {
      width: min(860px, 96vw);
      border: 1px solid var(--line);
      background: var(--panel);
      padding: 1rem;
    }

    h1 {
      margin: 0 0 0.8rem;
      font-size: 1.1rem;
      font-weight: 600;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 0.6rem;
      margin-bottom: 0.8rem;
    }

    .card {
      border: 1px solid var(--line);
      padding: 0.7rem;
      background: #050505;
    }

    .label {
      color: var(--muted);
      font-size: 0.78rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.3rem;
    }

    .value {
      color: var(--good);
      font-size: 1.05rem;
      font-weight: 600;
      font-variant-numeric: tabular-nums;
    }

    .upgrades {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 0.6rem;
    }

    .upgrade-title {
      font-size: 0.82rem;
      margin-bottom: 0.35rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .muted {
      color: var(--muted);
      font-size: 0.76rem;
      line-height: 1.35;
      margin: 0.15rem 0;
    }

    button {
      margin-top: 0.5rem;
      width: 100%;
      border: 1px solid #2a2a2a;
      color: var(--accent);
      background: #000;
      padding: 0.55rem;
      font-family: inherit;
      text-transform: uppercase;
      font-size: 0.72rem;
      letter-spacing: 0.06em;
      cursor: pointer;
    }

    button:hover:not(:disabled) {
      border-color: #6a6a6a;
    }

    button:disabled {
      color: #555;
      border-color: #1a1a1a;
      cursor: not-allowed;
    }
  </style>
</head>
<body>
  <main class="app">
    <h1>Stardust Incremental</h1>

    <section class="grid">
      <article class="card">
        <div class="label">Current Stardust</div>
        <div class="value" id="stardust">0</div>
      </article>

      <article class="card">
        <div class="label">Generation / Second</div>
        <div class="value" id="gps">1</div>
      </article>

      <article class="card">
        <div class="label">Current Boosts</div>
        <div class="muted" id="boosts"></div>
      </article>
    </section>

    <section class="upgrades">
      <article class="card">
        <div class="upgrade-title">Upgrade 1 · Dust Scoop</div>
        <p class="muted">+1 base generation each level.</p>
        <p class="muted" id="u1"></p>
        <button id="buy1">Buy</button>
      </article>

      <article class="card">
        <div class="upgrade-title">Upgrade 2 · Amplifier</div>
        <p class="muted">Increase generation by current % each level.</p>
        <p class="muted" id="u2"></p>
        <button id="buy2">Buy</button>
      </article>

      <article class="card">
        <div class="upgrade-title">Upgrade 3 · Calibration</div>
        <p class="muted">+10% to Upgrade 2 base effect each level.</p>
        <p class="muted" id="u3"></p>
        <button id="buy3">Buy</button>
      </article>

      <article class="card">
        <div class="upgrade-title">Upgrade 4 · Overcharge</div>
        <p class="muted">+100% multiplier to Upgrade 2 base effect each level.</p>
        <p class="muted" id="u4"></p>
        <button id="buy4">Buy</button>
      </article>
    </section>
  </main>

  <script>
    const game = {
      stardust: 0,
      upgrades: [0, 0, 0, 0],
      baseCosts: [10, 30, 70, 120]
    };

    const format = (n, digits = 2) =>
      n.toLocaleString(undefined, { maximumFractionDigits: digits });

    const upgradeCost = (index) => {
      const growth = [1.35, 1.8, 1.95, 2.05][index];
      return Math.floor(game.baseCosts[index] * Math.pow(growth, game.upgrades[index]));
    };

    const upgrade2BasePercentRaw = () => {
      const base = 20;
      const calibrationBoost = 1 + game.upgrades[2] * 0.10;
      const overchargeBoost = Math.pow(2, game.upgrades[3]);
      return base * calibrationBoost * overchargeBoost;
    };

    const dampenPercent = (rawPercent) => {
      if (rawPercent <= 120) {
        return rawPercent;
      }
      return 120 + Math.pow(rawPercent - 120, 0.62);
    };

    const generationPerSecond = () => {
      const baseGen = 1 + game.upgrades[0];
      const u2PercentEach = dampenPercent(upgrade2BasePercentRaw());
      const u2Levels = game.upgrades[1];

      const aggressivePart = Math.min(u2Levels, 12);
      const softenedPart = Math.max(0, u2Levels - 12);
      const aggressiveMultiplier = Math.pow(1 + u2PercentEach / 100, aggressivePart);
      const softenedMultiplier = Math.pow(1 + u2PercentEach / 230, softenedPart);

      return baseGen * aggressiveMultiplier * softenedMultiplier;
    };

    function buyUpgrade(index) {
      const cost = upgradeCost(index);
      if (game.stardust < cost) {
        return;
      }
      game.stardust -= cost;
      game.upgrades[index] += 1;
      render();
    }

    function render() {
      const gps = generationPerSecond();
      const u2Raw = upgrade2BasePercentRaw();
      const u2Effective = dampenPercent(u2Raw);

      document.getElementById('stardust').textContent = format(game.stardust);
      document.getElementById('gps').textContent = format(gps, 3);

      document.getElementById('boosts').innerHTML = [
        `base gen: <b>${format(1 + game.upgrades[0])}/s</b>`,
        `u2 raw effect: <b>${format(u2Raw)}%</b>`,
        `u2 effective effect: <b>${format(u2Effective)}%</b>`,
        `u2 levels: <b>${game.upgrades[1]}</b>`,
        `anti-inflation: softcap after 120% and after 12 u2 levels`
      ].join('<br>');

      const labels = [
        `lvl ${game.upgrades[0]} · next ${upgradeCost(0)} stardust`,
        `lvl ${game.upgrades[1]} · per level ${format(u2Effective)}% · next ${upgradeCost(1)}`,
        `lvl ${game.upgrades[2]} · next ${upgradeCost(2)} stardust`,
        `lvl ${game.upgrades[3]} · next ${upgradeCost(3)} stardust`
      ];

      ['u1', 'u2', 'u3', 'u4'].forEach((id, i) => {
        document.getElementById(id).textContent = labels[i];
        document.getElementById(`buy${i + 1}`).disabled = game.stardust < upgradeCost(i);
      });
    }

    document.getElementById('buy1').addEventListener('click', () => buyUpgrade(0));
    document.getElementById('buy2').addEventListener('click', () => buyUpgrade(1));
    document.getElementById('buy3').addEventListener('click', () => buyUpgrade(2));
    document.getElementById('buy4').addEventListener('click', () => buyUpgrade(3));

    setInterval(() => {
      game.stardust += generationPerSecond() / 20;
      render();
    }, 50);

    render();
  </script>
</body>
</html>
